---
title: 3-ElasticSearch 모니터링
tags:
  - 도서/기초부터-다지는-ElasticSearch-운영-노하우
---
## Head를 이용해서 모니터링하기

- Head는 클러스터의 상태를 한눈에 살펴볼 수 있는 모니터링 도구 중 하나이다.
- Head는 클러스터의 여러 정보를 웹 UI를 통해 확인할 수 있도록 해준다.
- 특히 Head의 가장 큰 장점 중 하나는 샤드 배치 정보를 시각적으로 확인할 수 있다는 것이다.

## 프로메테우스를 활용한 클러스터 모니터링

- 프로메테우스는 데이터를 시간의 흐름대로 저장할 수 있는 시계열 데이터베이스의 일종이며, 수집된 데이터를 바탕으로 임게치를 설정하고 경고 메시지를 받을 수 있는 오픈소스 모니터링 시스템이다.
- ![](assets/Pasted%20image%2020250211222724.png)
	- 각종 메트릭을 저장하는 TSDB(Time Series Data Base)의 역할을 하는 Prometheus Server가 중앙에 있다.
	- 각종 지표들은 Exporter라는 컴포넌트를 통해서 가져올 수 있고, Push Gateway를 통해서 입력할 수도 있다.
	- Alert Manager를 통해서 경고 메시지를 받을 수도 있다.
- 프로메테우스는 ElasticSearch 외에도 많은 시스템을 모니터링할 수 있는 Exporter를 제공해준다.
	- 그래서 Redis, Memached 등 다양한 시스템의 메트릭을 수집하고 모니터링할 수 있다.
- 그라파나는 프로메테우스를 비롯한 여러 데이터를 시각화해주는 모니터링 툴이다.

## X-Pack 모니터링 기능을 활용한 클러스터 모니터링

- ElasticSearch에 기본으로 탑재된 모니터링 기능
- ElasticSearch 6.3 버전 이전에는 베이직 라이선스의 경우 1년에 한 번씩 갱신해야 하기 떄문에 클러스터의 노드 대수가 많다면 모니터링 기능을 사용하기 어려운 것이 사실이다.
- 모니터링 데이터 자체를 클러스터에 쓰기 때문에 노드의 개수가 많은 대규모 클러스터라면 색인 성능에 영향을 줄 수도 있다.
- X-Pack 모니터링을 사용하기 위해서는 먼저 Kibana 설치가 필요하다.
	- Kibana 는 ElasticSearch에 저장된 로그를 검색하거나 그래프 등으로 시각화할 때 활용하는 도구이다.
- Kibana에서 Monitoring 메뉴에서 클러스터의 Health 상태, 노드 개수, 인덱스 개수 등을 볼 수 있다.

## 정리

| 모니터링 시스템    | 장점                             | 단점                                                       |
| ----------- | ------------------------------ | -------------------------------------------------------- |
| Head 모니터링   | 클러스터의 전반적인 동작 상태를 확인할 수 있다.    | 성능 지표등은 확인하기 어렵다.                                        |
| 프로메테우스 모니터링 | 다량의 클러스터를 운영하고 있을 때 구축하기 수월하다. | 확인할 수 있는 정보량이 X-Pack 모니터링에 비해 상대적으로 적다.                  |
| X-Pack 모니터링 | 모니터링 시스템 중 가장 많은 정보를 확인할 수 있다. | 6.3 이전 버전이라면 Basic 라이선스를 해마다 갱긴해야 하며, 색인 성능에 영향을 줄 수 있다. |
