# 람다로 프로그래밍

## 람다 식과 멤버 참조

### 람다 소개: 코드 블록을 함수 인자로 넘기기

- '이벤트가 발생하면 이 핸들러를 실행하자'나 '데이터 구조의 모든 원소에 이 연산을 적용하자'와 같은 생각을 코드로 표현하기 위해서 예전에는 무명 내부 클래스를 사용했다.
- 하지만 이는 코드가 너무 번잡스러워졌고, 자바 8부터 람다를 사용해 간결하게 작성할 수 있었다.
- 자바 컬렉션에 대해 수행하는 대부분 작업은 람다나 멤버 참조를 인자로 받는 함수를 통해 더 짧고 이해하기 쉽게 만들 수 있다.

### 람다 식의 문법

- 람다 식을 변수에 저장할 수 있다.

```kotlin
val sum = {x: Int, y: Int -> x + y}
```

- 함수 호출 시 맨 뒤에 있는 인자가 람다 식이라면 그 람다를 괄호 밖으로 빼낼 수 있다.

```kotlin
people.maxBy() {p: Person -> p.age}
```

- 람다가 어떤 함수의 유일한 인자이고 괄호 뒤에 람다를 썼다면 호출 시 빈 괄호를 없애도 된다.

```kotlin
people.maxBy {p: Person -> p.age}
```

- 로컬 변수처럼 컴파일러가 람다 파라미터의 타입도 추론할 수 있다.

```kotlin
people.maxBy {p -> p.age}
```

- 람다의 파라미터가 하나뿐이고 그 타입을 컴파일러가 추론할 수 있는 경우 `it`으로 바로 쓸 수 있다.
	- `it`을 남용하면 안된다. 람다 안에 람다가 중촙되는 경우 각 람다의 파라미터를 명시하는 편이 낫다.

```kotlin
people.maxBy { it.age }
```

- 람다의 본문이 여러 줄로 이뤄진 경우 본문의 맨 마지막에 있는 식이 람다의 결과 값이 된다.

```kotlin
println("Computing the sum of $x and $y...")
```

### 현재 영역에 있는 변수에 접근

- 람다는 람다 밖에 있는 변수에 접근할 수 있다.
- 코틀린은 자바와 다르게 람다 안에서 파이널 변수가 아닌 변수에도 접근하고 변경할 수 있다.
	- 변경 가능한 변수를 필드로 하는 클래스를 선언하는 기법을 사용한다.
	![](assets/Pasted%20image%2020230210102240.png)
- 람다가 포획(capture)한 변수: 람다 안에서 사용하는 외부 변수

### 멤버 참조

- 멤버 참조: 이중 콜론(`::`)을 사용하여 프로퍼티나 메소드를 단 하나만 호출하는 함수 값을 만들어주는 것

```kotlin
Person::age
```

- 최상위에 선언된 함수나 프로퍼티를 참조할 수도 있다.
	- REPL에서는 불가능하다.

```kotlin
fun salute() = print("Salute!")
run(::salute)
```

- 인자가 여럿인 함수에서도 가능하다.

```kotlin
val action = { person: Person, message: String -> 
	sendEmail(person, message)
}
val nextAction = ::sendEmail
```

- 생성자 참조를 사용하면 클래스 생성 작업을 연기하거나 저장해둘 수 있다.

```kotlin
data class Person(val name: String, val age: Int)

val createPerson = ::Person
val p = createPerson("Alice", 29)
```

- 확장 함수도 멤버 함수와 똑같은 방식으로 참조할 수 있다.
- 바운드 멤버 참조: 멤버 참조를 생성할 때 클래스 인스턴스를 함께 저장한 다음 나중에 그 인스턴스에 대해 멤버를 호출해준다.

![](assets/Pasted%20image%2020230210103944.png)