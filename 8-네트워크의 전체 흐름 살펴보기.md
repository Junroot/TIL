---
tags:
  - 도서/모두의-네트워크
title: 8-네트워크의 전체 흐름 살펴보기
---



## 랜 카드에서의 데이터 전달과 처리

- 웹 브라우저에 URL을 입력하고 엔터키를 누르면 일어나는 과정
    - TCP 3-way 핸드셰이크가 일어난다.
    - HTTP request 메시지를 만든다.
    - 전송 계층으로 전달된다. TCP 헤더가 붙어서 출발지 포트 넘버, 목적지 포트 넘버 등이 추가된다. (세그먼트)
    - 네트워크 계층으로 전달된다. IP 헤더가 붙어서 출발지 IP, 목적지 IP 주소 등이 추가된다. (IP 패킷)
    - 데이터 링크 계층으로 전달된다. 이더넷 헤더와 트레일러가 붙어서 출발지 MAC, 목적지 MAC 주소 등이 추가된다.(이더넷 프레임)
    - 물리 계층으로 넘어가서, 랜 카드가 전기 신호로 변환 시킨다.

## 스위치와 라우터에서의 데이터 전달과 처리

- 스위치에 데이터가 올 때 처리 과정
    - 물리 계층에서 전기 신호를 데이터로 변환한다.
    - 데이터 링크 계층에서 목적지 MAC 주소를 MAC 주소 테이블에서 찾는다.
    - 물리 계층에서 데이터를 다시 전기 신호로 변환시킨다.
- 라우터에 데이터가 올 때 처리 과정
    - 물리 계층에서 전기 신호를 데이터로 변환한다.
    - 데이터 링크 계층에서 목적지 MAC 주소가 자신이 맞는지 확인하고 아니라면 데이터를 버린다.
    - 네트워크 계층에서 라우팅 테이블을 확인해 라우팅을 하고, 출발지 IP 주소를 자신의 IP 주소로 변환한다.
        - 외부 네트워크면 public IP, 자신이 속해있는 네트워크면 private IP.
    - 데이터 링크 계층에서 목적지 MAC 주소에 자신의 MAC 주소를, 출발지 MAC 주소에 다음에 도착할 라우터나 컴퓨터의 MAC 주소를 이더넷 헤더로 붙인다.
    - 물리 계층에서 데이터를 전기 신호로 변환한다.

## 웹 서버에서의 데이터 전달과 처리

- 웹 서버에 데이터가 올 때 처리 과정
    - 데이터 링크 계층에서 이더넷 프레임의 목적지 MAC 주소와 자신의 MAC 주소가 같은지 비교한다. 주소가 같으면 이더넷 헤더와 트레일러를 분리하고 네트워크 계층에 전달한다.
    - 네트워크 계층에서 목적지 IP주소와 웹 서버의 IP주소가 같은지 확인힌다. 주소가 같으면 IP 헤더를 분리하고 전송 계층에 전달한다.
    - 전송 계층에서 목적지 포트 번호를 확인하여 어떤 애플리케이션으로 전달해야 되는지 판단하고 TCP 헤더를 분리하여 응용 계층에 전달한다.
