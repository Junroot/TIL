---
title: 1-계층형 아키텍처의 문제는 무엇일까?
tags:
  - 도서/만들면서-배우는-클린-아키텍처
---
![](assets/Pasted%20image%2020241022231344.png)

- 계층형 아키텍처는 코드에 나쁜 습관들이 스며들기 쉽게 만들고 시간이 지날수록 소프트웨어를 점점 더 변경하기 어렵게 만드는 수많은 허점들을 노출한다.

## 계층형 아키텍처는 데이터베이스 주도 설계를 유도한다

- 웹 계층은 도메인 계층에 의존하고, 도메인 계층은 영속성 계층에 의존하기 때문에 자연스레 데이터베이스에 의존하게 된다.
- 애플리케이션을 개발할 때 상태가 아니라 행동을 중심으로 모델링 해야한다.
	- 행동이 상태를 바꾸는 주체이기 때문에 행동이 비즈니스를 이끌어간다.
- 하지만 전통적인 계층형 아키텍처에서는 데이터베이스의 구조를 먼저 생각하고, 이를 토대로 도메인 로직을 구현하게 된다.
- 데이터베이스 중심적인 아키텍처가 만들어지는 가장 큰 원인은 ORM 프레임워크를 사용하기 때문이다.
	- ORM 프레임워크를 계층형 아키텍처와 결합하면 비즈니스 규칙을 영속성 관점과 섞고 싶은 유혹을 쉽게 받는다.
	- 일반적으로 ORM에서 관리되는 엔티티들은 영속성 계층에 둔다. 이렇게 되면 영속성 계층과 도메인 계층 사이에 강한 결합이 생긴다.
	- 영속성 모델을 비즈니스 모델처럼 사용하게 되고 이로 인해 도메인 로직뿐만 아니라 즉시로딩/지연로딩, 데이터베이스 트랜잭션, 캐시 플러시 등등 영속성 계층과 관련된 작업들을 서비스에서 하게된다.
	- ![](assets/Pasted%20image%2020241022232149.png)

## 지름길을 택하기 쉬워진다

 - 만약 상위 계층에 위치한 컴포넌트에 접근해야 한다면 간단하게 컴포넌트를 계층 아래로 내려버리려고 해버릴 것이다.
 - 이렇게 되면 영속성 계층에서는 모든 것에 접근 가능하게 되어 점점 비대해진다.
	 - 어떤 계층에도 속하지 않는 것처럼 보이는 헬퍼 컴포넌트나 유틸리티 컴포넌트들이 이처럼 아래 계층으로 내릴 가능성이 큰 후보다.
	 - ![](assets/Pasted%20image%2020241022232735.png)

## 테스트하기 어려워진다
